{
  "info": {
    "name": "Reputation Manager API",
    "description": "API REST para gestión de feedback de profesionales de la salud",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_postman_id": "reputation-manager-api",
    "version": "1.0.0"
  },
  "auth": {
    "type": "noauth"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "workspaceId",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Sign Up",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"doctor@ejemplo.com\",\n  \"password\": \"password123\",\n  \"name\": \"Dr. Juan Pérez\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/sign-up/email",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "sign-up", "email"]
            },
            "description": "Registrar un nuevo usuario con email y contraseña"
          }
        },
        {
          "name": "Sign In",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"doctor@ejemplo.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/sign-in/email",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "sign-in", "email"]
            },
            "description": "Iniciar sesión con email y contraseña"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Better Auth usa cookies automáticamente",
                  "// No necesitas hacer nada, las cookies se guardan automáticamente"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Get Session",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/auth/get-session",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "get-session"]
            },
            "description": "Obtener información de la sesión actual"
          }
        },
        {
          "name": "Sign Out",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/auth/sign-out",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "sign-out"]
            },
            "description": "Cerrar sesión"
          }
        }
      ],
      "description": "Endpoints de autenticación con Better Auth"
    },
    {
      "name": "Workspaces",
      "item": [
        {
          "name": "List My Workspaces",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/workspaces",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces"]
            },
            "description": "Obtener todos los workspaces del usuario autenticado"
          }
        },
        {
          "name": "Create Workspace",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Mi Consultorio\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/workspaces",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces"]
            },
            "description": "Crear un nuevo workspace y asignar al usuario como OWNER"
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Guardar workspaceId automáticamente",
                  "if (pm.response.code === 201) {",
                  "    var jsonData = pm.response.json();",
                  "    pm.collectionVariables.set('workspaceId', jsonData.id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Get Workspace",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces", "{{workspaceId}}"]
            },
            "description": "Obtener un workspace específico"
          }
        },
        {
          "name": "Update Workspace",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Consultorio Actualizado\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces", "{{workspaceId}}"]
            },
            "description": "Actualizar un workspace (solo OWNER)"
          }
        },
        {
          "name": "Delete Workspace",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces", "{{workspaceId}}"]
            },
            "description": "Eliminar un workspace (solo OWNER, sin otros usuarios)"
          }
        }
      ],
      "description": "Gestión de workspaces (tenants)"
    },
    {
      "name": "Practices",
      "item": [
        {
          "name": "List Practices",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}/practices",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces", "{{workspaceId}}", "practices"]
            },
            "description": "Listar todas las practices de un workspace"
          }
        },
        {
          "name": "Create Practice",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Consultorio Centro\",\n  \"address\": \"Av. 10 de Agosto N45-123, Quito\",\n  \"phone\": \"+593987654321\",\n  \"googlePlaceId\": \"ChIJN1t_tDeuEmsRUsoyG83frY4\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}/practices",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces", "{{workspaceId}}", "practices"]
            },
            "description": "Crear una nueva practice (OWNER o DOCTOR)"
          }
        },
        {
          "name": "Get Practice",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/practices/:practiceId",
              "host": ["{{baseUrl}}"],
              "path": ["practices", ":practiceId"],
              "variable": [
                {
                  "key": "practiceId",
                  "value": ""
                }
              ]
            },
            "description": "Obtener una practice específica"
          }
        },
        {
          "name": "Update Practice",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Consultorio Centro Actualizado\",\n  \"phone\": \"+593999888777\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/practices/:practiceId",
              "host": ["{{baseUrl}}"],
              "path": ["practices", ":practiceId"],
              "variable": [
                {
                  "key": "practiceId",
                  "value": ""
                }
              ]
            },
            "description": "Actualizar una practice (OWNER o DOCTOR)"
          }
        },
        {
          "name": "Delete Practice",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/practices/:practiceId",
              "host": ["{{baseUrl}}"],
              "path": ["practices", ":practiceId"],
              "variable": [
                {
                  "key": "practiceId",
                  "value": ""
                }
              ]
            },
            "description": "Eliminar una practice (solo OWNER)"
          }
        }
      ],
      "description": "Gestión de ubicaciones físicas (consultorios)"
    },
    {
      "name": "Workspace Users",
      "item": [
        {
          "name": "List Users",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}/users",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces", "{{workspaceId}}", "users"]
            },
            "description": "Listar todos los usuarios del workspace"
          }
        },
        {
          "name": "Invite User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"nuevo@ejemplo.com\",\n  \"role\": \"DOCTOR\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}/users/invite",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces", "{{workspaceId}}", "users", "invite"]
            },
            "description": "Invitar un usuario al workspace (OWNER o DOCTOR)"
          }
        },
        {
          "name": "Update User Role",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"role\": \"RECEPTIONIST\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}/users/:userId/role",
              "host": ["{{baseUrl}}"],
              "path": [
                "workspaces",
                "{{workspaceId}}",
                "users",
                ":userId",
                "role"
              ],
              "variable": [
                {
                  "key": "userId",
                  "value": ""
                }
              ]
            },
            "description": "Cambiar el rol de un usuario (solo OWNER)"
          }
        },
        {
          "name": "Remove User",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/workspaces/{{workspaceId}}/users/:userId",
              "host": ["{{baseUrl}}"],
              "path": ["workspaces", "{{workspaceId}}", "users", ":userId"],
              "variable": [
                {
                  "key": "userId",
                  "value": ""
                }
              ]
            },
            "description": "Remover un usuario del workspace (permisos según rol)"
          }
        }
      ],
      "description": "Gestión de usuarios y permisos en workspaces"
    }
  ]
}
